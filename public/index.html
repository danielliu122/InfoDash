<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary Meta Tags -->
    <title>InfoDash - Summary Dashboard</title>
    <meta name="title" content="InfoDash - Summary Dashboard">
    <meta name="description" content="Your all-in-one dashboard for daily summaries, market trends, weather, and news updates.">
    
    <!-- Fonts and Stylesheets -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans+Text:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
    
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    
    <!-- Application Scripts -->
    <script src="js/sidebar.js"></script>
    <script type="module" src="js/userPreferences.js"></script>
    <script type="module" src="js/app.js"></script>
    <script type="module" src="js/summary.js"></script>
    <script type="module" src="js/weather.js"></script>
</head>
<body class="dark-theme">
    <header class="container">
        <div style="display: flex; align-items: center; justify-content: space-between;">
            <h4 class="center-align" style="margin: 0;">InfoDash - Summary</h4>
            
            <!-- Weather Display -->
            <div id="weather-display" onclick="handleWeatherClick()" style="cursor: pointer; display: flex; align-items: center; gap: 10px;">
                <div style="text-align: right;">
                    <div id="weather-temp" style="font-size: 1.2em; font-weight: 500;">--¬∞</div>
                    <span id="weather-location" style="font-size: 0.7em; color: var(--text-secondary);">Loading...</span>
                </div>
            </div>
            
            <button class="theme-toggle" id="themeToggle">üåì</button>
        </div>
    </header>
    
    <main class="container">
        <!-- Unified Summary Section -->
        <div class="row">
            <div class="col s12">
                <section id="summary-section" class="section">
                    <div class="section-header">
                        <h4>üìäSummary Date: <span id="titleDate"></span></h4>
                        <div class="right">
                            <div class="section-controls">
                                <button id="summary-refresh-btn" class="btn-small waves-effect waves-light" onclick="refreshSummary()">üîÑ Refresh</button>
                            </div>
                        </div>
                        <div class="section-toggle" onclick="toggleSection('summary-content-container')" title="Show/Hide Section">
                            <span class="toggle-icon">‚àí</span>
                        </div>
                    </div>

                    <!-- Location Modal -->
                    <div id="locationModal" class="modal">
                        <div class="modal-content">
                            <h4>Set Weather Location</h4>
                            <p>Enter your location for weather information in the summary:</p>
                            <div class="input-field">
                                <input type="text" id="weatherLocationInput" placeholder="e.g., New York, NY or 10001">
                                <label for="weatherLocationInput">Location (City, State or ZIP)</label>
                            </div>
                            <p class="small-text">Examples: "San Francisco, CA", "New York, NY", "90210", "London, UK"</p>
                        </div>
                        <div class="modal-footer">
                            <button class="modal-close waves-effect waves-light btn" onclick="setWeatherLocation()">Set Location</button>
                            <button class="modal-close waves-effect waves-light btn-flat" onclick="closeLocationModal()">Cancel</button>
                        </div>
                    </div>

                    <div id="summary-content-container" class="section-content">
                        <!-- Summary Display -->
                        <div class="summary-loading">
                            <div class="progress">
                                <div class="indeterminate"></div>
                            </div>
                            <p class="center-align" id="summary-loading-text">Loading today's summary...</p>
                        </div>
                        <div class="summary-content" style="display: none;">
                            <!-- Summary cards will be here -->
                            <div class="row">
                                <div class="col s12 m4">
                                    <div class="summary-card news-summary">
                                        <h5>üì∞ Top Headlines</h5>
                                        <div class="summary-text"></div>
                                    </div>
                                </div>
                                <div class="col s12 m4">
                                    <div class="summary-card trends-summary">
                                        <h5>üî• Trending Topics</h5>
                                        <div class="summary-text"></div>
                                    </div>
                                </div>
                                <div class="col s12 m4">
                                    <div class="summary-card finance-summary">
                                        <h5>üìà Market Overview</h5>
                                        <div class="summary-text"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col s12 m6">
                                    <div class="summary-card weather-summary">
                                        <h5>üå§Ô∏è Weather Update
                                            <button onclick="showLocationModal()" class="btn-small waves-effect waves-light" style="margin-left: 10px; font-size: 0.8em;">üìç Set Location</button>
                                        </h5>
                                        <div class="weather-info">
                                            <div class="weather-location"></div>
                                            <div class="weather-updated"></div>
                                            <p class="weather-condition"></p>
                                            <p class="weather-temp"></p>
                                            <p class="weather-feelslike"></p>
                                            <p class="weather-humidity"></p>
                                            <p class="weather-wind"></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col s12 m6">
                                    <div class="summary-card overall-summary">
                                        <h5>üéØ Key Insights</h5>
                                        <div class="summary-text"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- AI Disclaimer -->
                        <div class="row">
                            <div class="col s12">
                                <p style="font-style: italic; color: #9e9e9e; font-size: 0.85em; text-align: center; margin-top: 20px; margin-bottom: 0;">
                                    ‚ö†Ô∏è This summary is AI-generated for informational purposes only and should not be considered as financial, legal, or professional advice.
                                </p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <!-- Hidden sections for data generation (not visible to users) -->
        <div style="display: none;">
            <!-- News Section (Hidden) -->
            <section id="news" class="section">
                <div class="section-header">
                    <h4>üì∞ News</h4>
                </div>
                <div id="news-controls" class="row">
                    <div class="input-field col s6">
                        <select id="countrySelect">
                            <option value="US">United States</option>
                            <option value="GB">United Kingdom</option>
                            <option value="CA">Canada</option>
                            <option value="AU">Australia</option>
                            <option value="DE">Germany</option>
                            <option value="FR">France</option>
                            <option value="JP">Japan</option>
                            <option value="IN">India</option>
                            <option value="BR">Brazil</option>
                            <option value="KR">South Korea</option>
                            <option value="IT">Italy</option>
                            <option value="ES">Spain</option>
                            <option value="MX">Mexico</option>
                            <option value="RU">Russia</option>
                        </select>
                        <label for="countrySelect">Country</label>
                    </div>
                    <div class="input-field col s6">
                        <select id="languageSelect">
                            <option value="en">English</option>
                            <option value="es">Espa√±ol</option>
                            <option value="fr">Fran√ßais</option>
                            <option value="de">Deutsch</option>
                            <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                            <option value="zh">‰∏≠Êñá</option>
                            <option value="jp">Êó•Êú¨Ë™û</option>
                            <option value="ko">ÌïúÍµ≠Ïñ¥</option>
                            <option value="pt">Portugu√™s</option>
                            <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
                            <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
                            <option value="it">Italiano</option>
                        </select>
                        <label for="languageSelect">Language</label>
                    </div>
                </div>
                <div class="data-container"></div>
            </section>

            <!-- Finance Section (Hidden) -->
            <section id="finance" class="section">
                <div class="section-header">
                    <h4>üìà Finance</h4>
                </div>
                <div class="input-field">
                    <input type="text" id="stockSymbolInput" placeholder="Enter stock symbol (e.g., AAPL)">
                    <label for="stockSymbolInput">Stock Symbol</label>
                </div>
                <div class="chart-container">
                    <canvas id="stockChart"></canvas>
                </div>
                <div class="data-container"></div>
                <div id="stock-dashboard" class="stock-dashboard"></div>
            </section>

            <!-- Trends Section (Hidden) -->
            <section id="trends" class="section">
                <div class="section-header">
                    <h4>üî• Trends</h4>
                </div>
                <div id="trends-controls" class="row">
                    <div class="input-field col s6">
                        <select id="trendsCountrySelect">
                            <option value="US">United States</option>
                            <option value="GB">United Kingdom</option>
                            <option value="CA">Canada</option>
                            <option value="AU">Australia</option>
                            <option value="DE">Germany</option>
                            <option value="FR">France</option>
                            <option value="JP">Japan</option>
                            <option value="IN">India</option>
                            <option value="BR">Brazil</option>
                            <option value="KR">South Korea</option>
                            <option value="IT">Italy</option>
                            <option value="ES">Spain</option>
                        </select>
                        <label for="trendsCountrySelect">Country</label>
                    </div>
                    <div class="input-field col s6">
                        <select id="trendsLanguageSelect">
                            <option value="en">English</option>
                            <option value="es">Espa√±ol</option>
                            <option value="fr">Fran√ßais</option>
                            <option value="de">Deutsch</option>
                            <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                            <option value="zh">‰∏≠Êñá</option>
                            <option value="jp">Êó•Êú¨Ë™û</option>
                            <option value="ko">ÌïúÍµ≠Ïñ¥</option>
                            <option value="pt">Portugu√™s</option>
                        </select>
                        <label for="trendsLanguageSelect">Language</label>
                    </div>
                </div>
                <div class="data-container"></div>
            </section>

            <!-- Reddit Section (Hidden) -->
            <section id="reddit" class="section">
                <div class="section-header">
                    <h4>üî¥ Reddit</h4>
                </div>
                <div class="data-container"></div>
            </section>
        </div>
    </main>

    <script type="module">
        import { showNotification, toggleSection, showLocationModal, closeLocationModal } from './js/uiUtils.js';
        import { acceptCookies, declineCookies, resetCookieConsent, checkCookieConsent, showCookieBanner, hideCookieBanner, clearAllPreferences, updatePreferencesDisplay } from './js/userPreferences.js';
        import { initializeGeolocation, setRegion, getCurrentRegion, handleRegionChange } from './js/geolocation.js';
        import { updateHeaderWeather, updateSummaryWeather, setWeatherLocation, handleWeatherClick } from './js/weather.js';
        
        window.showNotification = showNotification;
        window.toggleSection = toggleSection;
        window.showLocationModal = showLocationModal;
        window.closeLocationModal = closeLocationModal;
        window.acceptCookies = acceptCookies;
        window.declineCookies = declineCookies;
        window.resetCookieConsent = resetCookieConsent;
        window.checkCookieConsent = checkCookieConsent;
        window.showCookieBanner = showCookieBanner;
        window.hideCookieBanner = hideCookieBanner;
        window.clearAllPreferences = clearAllPreferences;
        window.updatePreferencesDisplay = updatePreferencesDisplay;
        window.handleRegionChange = handleRegionChange;
        window.setRegion = setRegion;
        window.getCurrentRegion = getCurrentRegion;
        window.setWeatherLocation = setWeatherLocation;
        window.handleWeatherClick = handleWeatherClick;
        
        // Initialize Materialize components and weather
        document.addEventListener('DOMContentLoaded', function() {
            M.AutoInit();
            // Initialize weather display
            updateHeaderWeather();
            updateSummaryWeather();
        });
    </script>
</body>
</html>
